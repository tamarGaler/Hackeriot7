import sqlite3

connection = sqlite3.connect('example.db')
cursor = connection.cursor()

# Vulnerable to SQL Injection
# ruleid:sql-injection
user_input = "' OR 1=1 --"
query = "SELECT * FROM users WHERE username = '%s'" % user_input
cursor.execute(query)

# Safe from SQL Injection
# ok:sql-injection
user_input = "admin"
cursor.execute("SELECT * FROM users WHERE username = ?", (user_input,))

# Another vulnerable example
# ruleid:sql-injection
def unsafe_query(username):
    query = f"SELECT * FROM users WHERE username = '{username}'"
    cursor.execute(query)

# Another safe example
# ok:sql-injection
def safe_query(username):
    query = "SELECT * FROM users WHERE username = ?"
    cursor.execute(query, (username,))
